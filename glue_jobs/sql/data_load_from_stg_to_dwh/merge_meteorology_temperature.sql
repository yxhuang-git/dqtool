MERGE INTO ${schemaTo}.${dwh_table} AS target
USING ${schemaFrom}.${stg_table} AS source
ON target.OBSERVATORY_NO = source.OBSERVATORY_NO AND 
target.YEAR_NOW = source.YEAR_NOW AND 
target.MONTH_NOW = source.MONTH_NOW AND 
target.DAY_NOW = source.DAY_NOW AND 
target.HOUR_NOW = source.HOUR_NOW AND 
target.MINUTE_NOW = source.MINUTE_NOW
WHEN MATCHED THEN
    UPDATE SET 
            target.PREFECTURES = source.PREFECTURES, 
            target.PLACE = source.PLACE, 
            target.INTERNATIONAL_PRICE = source.INTERNATIONAL_PRICE, 
            target.MAX_TEMPERATURE_THE_DAY = source.MAX_TEMPERATURE_THE_DAY, 
            target.QUALITY_MAX_TEMPERATURE_THE_DAY = source.QUALITY_MAX_TEMPERATURE_THE_DAY, 
            target.HOUR_MAX_TEMPERATURE_THE_DAY_START = source.HOUR_MAX_TEMPERATURE_THE_DAY_START, 
            target.MINUTE_MAX_TEMPERATURE_THE_DAY_START = source.MINUTE_MAX_TEMPERATURE_THE_DAY_START, 
            target.QUALITY_MAX_TEMPERATURE_THE_DAY_START = source.QUALITY_MAX_TEMPERATURE_THE_DAY_START, 
            target.DEVIATION_TEMPERATURE_COMMON_YEAR = source.DEVIATION_TEMPERATURE_COMMON_YEAR, 
            target.DEVIATION_TEMPERATURE_THE_DAY_BEFORE = source.DEVIATION_TEMPERATURE_THE_DAY_BEFORE, 
            target.MONTH_THE_TENDAY_PERIOD = source.MONTH_THE_TENDAY_PERIOD,
            target.TENDAY_THE_TENDAY_PERIOD = source.TENDAY_THE_TENDAY_PERIOD,
            target.EXTREME_VALUE_UPDATE = source.EXTREME_VALUE_UPDATE, 
            target.EXTREME_VALUE_LESS_TEN_YEARS_UPDATE = source.EXTREME_VALUE_LESS_TEN_YEARS_UPDATE, 
            target.HIGHEST_THIS_YEAR = source.HIGHEST_THIS_YEAR, 
            target.MAX_TEMPERATURE_THIS_YEAR = source.MAX_TEMPERATURE_THIS_YEAR, 
            target.QUALITY_MAX_TEMPERATURE_THIS_YEAR = source.QUALITY_MAX_TEMPERATURE_THIS_YEAR, 
            target.YEAR_MAX_TEMPERATURE_THIS_YEAR = source.YEAR_MAX_TEMPERATURE_THIS_YEAR, 
            target.MONTH_MAX_TEMPERATURE_THIS_YEAR = source.MONTH_MAX_TEMPERATURE_THIS_YEAR, 
            target.DAY_MAX_TEMPERATURE_THIS_YEAR = source.DAY_MAX_TEMPERATURE_THIS_YEAR, 
            target.TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE = source.TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE, 
            target.QUALITY_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE = source.QUALITY_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE, 
            target.YEAR_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE = source.YEAR_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            target.MONTH_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE = source.MONTH_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            target.DAY_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE = source.DAY_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            target.MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE = source.MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            target.QUALITY_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE = source.QUALITY_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            target.YEAR_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE = source.YEAR_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            target.MONTH_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE = source.MONTH_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            target.DAY_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE = source.DAY_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            target.YEAR_STATISTICS_START = source.YEAR_STATISTICS_START
WHEN NOT MATCHED THEN
    INSERT 
        (
            OBSERVATORY_NO, 
            PREFECTURES, 
            PLACE, 
            INTERNATIONAL_PRICE, 
            YEAR_NOW, 
            MONTH_NOW, 
            DAY_NOW, 
            HOUR_NOW, 
            MINUTE_NOW, 
            MAX_TEMPERATURE_THE_DAY, 
            QUALITY_MAX_TEMPERATURE_THE_DAY, 
            HOUR_MAX_TEMPERATURE_THE_DAY_START, 
            MINUTE_MAX_TEMPERATURE_THE_DAY_START, 
            QUALITY_MAX_TEMPERATURE_THE_DAY_START, 
            DEVIATION_TEMPERATURE_COMMON_YEAR, 
            DEVIATION_TEMPERATURE_THE_DAY_BEFORE, 
            MONTH_THE_TENDAY_PERIOD,
            TENDAY_THE_TENDAY_PERIOD,
            EXTREME_VALUE_UPDATE, 
            EXTREME_VALUE_LESS_TEN_YEARS_UPDATE, 
            HIGHEST_THIS_YEAR, 
            MAX_TEMPERATURE_THIS_YEAR, 
            QUALITY_MAX_TEMPERATURE_THIS_YEAR, 
            YEAR_MAX_TEMPERATURE_THIS_YEAR, 
            MONTH_MAX_TEMPERATURE_THIS_YEAR, 
            DAY_MAX_TEMPERATURE_THIS_YEAR, 
            TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE, 
            QUALITY_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE, 
            YEAR_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            MONTH_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            DAY_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            QUALITY_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            YEAR_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            MONTH_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            DAY_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            YEAR_STATISTICS_START
        )
    VALUES 
        (
            source.OBSERVATORY_NO, 
            source.PREFECTURES, 
            source.PLACE, 
            source.INTERNATIONAL_PRICE, 
            source.YEAR_NOW, 
            source.MONTH_NOW, 
            source.DAY_NOW, 
            source.HOUR_NOW, 
            source.MINUTE_NOW, 
            source.MAX_TEMPERATURE_THE_DAY, 
            source.QUALITY_MAX_TEMPERATURE_THE_DAY, 
            source.HOUR_MAX_TEMPERATURE_THE_DAY_START, 
            source.MINUTE_MAX_TEMPERATURE_THE_DAY_START, 
            source.QUALITY_MAX_TEMPERATURE_THE_DAY_START, 
            source.DEVIATION_TEMPERATURE_COMMON_YEAR, 
            source.DEVIATION_TEMPERATURE_THE_DAY_BEFORE, 
            source.MONTH_THE_TENDAY_PERIOD,
            source.TENDAY_THE_TENDAY_PERIOD,
            source.EXTREME_VALUE_UPDATE, 
            source.EXTREME_VALUE_LESS_TEN_YEARS_UPDATE, 
            source.HIGHEST_THIS_YEAR, 
            source.MAX_TEMPERATURE_THIS_YEAR, 
            source.QUALITY_MAX_TEMPERATURE_THIS_YEAR, 
            source.YEAR_MAX_TEMPERATURE_THIS_YEAR, 
            source.MONTH_MAX_TEMPERATURE_THIS_YEAR, 
            source.DAY_MAX_TEMPERATURE_THIS_YEAR, 
            source.TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE, 
            source.QUALITY_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE, 
            source.YEAR_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            source.MONTH_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            source.DAY_TOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            source.MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            source.QUALITY_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            source.YEAR_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            source.MONTH_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            source.DAY_MONTHTOP1_TEMPERATURE_UNTIL_THE_DAY_BEFORE,
            source.YEAR_STATISTICS_START
        );
